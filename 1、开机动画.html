<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
<!--创建外部容器-->
<div class="wrap">
<!--        创建遮罩层-->
        <div id="mask">
            <div class="maskTop"></div>
            <div class="maskBottom"></div>
            <span class="maskLine"></span>
        </div>
<!--        创建头部-->
        <div id="header">
<!--            创建头部内部容器-->
            <div class="headerMain">
<!--                创建logo-->
                <h1 class="logo">
                    <a href="javascropt:;"><img src="img/logo.png" alt=""></a>
                </h1>
                <div class="music">
<!--                    loop循环播放   muted是否静音  -->
                    <audio src="img/audio.mp3" loop multed autoplay></audio>
                </div>
<!--                创建导航-->
                <div class="nav">
                    <ul>
                        <li>
                            <a href="javascript:;">
                                <div class="up"><img src="img/home_gruen.png" alt=""></div>
                                <div class="down"><img src="img/home.png" alt=""></div>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:;">
                                <div class="up">Course</div>
                                <div class="down">Course</div>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:;">
                                <div class="up">Works</div>
                                <div class="down">Works</div>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:;">
                                <div class="up">About</div>
                                <div class="down">About</div>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:;">
                                <div class="up">Team</div>
                                <div class="down">Team</div>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- 创建小三角-->
                <div class="arrow"></div>
            </div>
        </div>
<!--        创建内容区-->
        <div id="content">
<!--            创建侧边栏-->
            <ul class="menuBar">
                <li class="active"></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
            </ul>
            <ul class="list">
                <li>
                    <div class="home">
                        <ul class="homeList">
                            <li class="active">
                                <div class="commonTitle">one later</div>
                            </li>
                            <li>
                                <div class="commonTitle">two later</div>
                            </li>
                            <li>
                                <div class="commonTitle">three later</div>
                            </li>
                            <li>
                                <div class="commonTitle">four later</div>
                            </li>
                        </ul>
                        <ul class="homeIcon">
                            <li class="active"></li>
                            <li></li>
                            <li></li>
                            <li></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="course">
                        <header class="course1">
                            <h2 class="commonTitle">
                                <span>EINIGE</span><br>
                                <span>UNSERER</span><br>
                                <span>KUNDEN</span>
                            </h2>
                        </header>
                        <div class="course2">
                            <p class="commonText">
                                Das Kundenvertrauen in unsere Kompetenz ist die notwendige Basis einer erfolgreichen Zusammenarbeit, gleichzeitig aber auch das größte Lob, das man uns entgegenbringen kann.
                                <br>
                                Diese und viele weitere große und kleine Kunden vertrauen uns seit Jahren, was uns stolz macht, und dafür sagen wir an dieser Stelle einfach mal.
                            </p>

                        </div>
                        <div class="course3">
                            <div class="line"></div>
                            <div class="line"></div>
                            <div class="line"></div>
                            <div class="line"></div>
                            <div class="line"></div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="itemInner">
                                    <div class="front"></div>
                                    <div class="back">yffzm</div>
                                </div>
                            </div>
                        </div>
                        <div class="plane1"></div>
                        <div class="plane2"></div>
                        <div class="plane3"></div>
                    </div>
                </li>
                <li>
                    <div class="works">
                        <header class="works1">
                            <h2 class="commonTitle">
                                <span>EINBLICK</span><br>
                                <span>ERKENNTNIS</span><br>
                                <span>ERGEBNIS</span>
                            </h2>
                        </header>
                        <div class="works2">
                            <div class="item">
                                <img src="img/worksimg1.jpg" alt="">
                                <div class="mask">
                                    <span>在我家后花园</span>
                                    <div class="icon"></div>
                                </div>
                            </div>
                            <div class="item">
                                <img src="img/worksimg2.jpg" alt="">
                                <div class="mask">
                                    <span>在我家后花园</span>
                                    <div class="icon"></div>
                                </div>
                            </div>
                            <div class="item">
                                <img src="img/worksimg3.jpg" alt="">
                                <div class="mask">
                                    <span>在我家后花园</span>
                                    <div class="icon"></div>
                                </div>
                            </div>
                            <div class="item">
                                <img src="img/worksimg4.jpg" alt="">
                                <div class="mask">
                                    <span>在我家后花园</span>
                                    <div class="icon"></div>
                                </div>
                            </div>
                        </div>
                        <div class="works3"></div>
                        <div class="pencel1"></div>
                        <div class="pencel2"></div>
                        <div class="pencel3"></div>
                    </div>
                </li>
                <li>
                    <div class="about">
                        <header class="about1">
                            <h2 class="commonTitle">
                                <span>DIE</span><br>
                                <span>SPEZIELLE</span><br>
                                <span>VIELFALT</span>
                            </h2>
                        </header>
                        <div class="about2">
                            <p class="commonText">
                                Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen
                            </p>
                        </div>
                        <div class="about3">
                            <div class="item">
<!--                                放底图-->
                                <span></span>
                                <ul data-src="img/about1.jpg"></ul>
                            </div>
                            <div class="item">
                                <span></span>
                                <ul data-src="img/about3.jpg"></ul>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="team">
                        <header class="team1">
                            <span class="commonTitle">WIR SIND</span><br>
                            <span class="commonTitle">VOXELAIR</span>
                        </header>
                        <div class="team2">
                            <p class="commonText">
                                Wir sind seit 2002 eine Full-Service-Werbeagentur mit Stammsitz in Heimsheim, zwischen Stuttgart und Karlsruhe.
                                <br>
                                Über 60 Jahre Erfahrung vereinen das gesamte VoxelAir-Team. Dabei hat jedes Voxel neben professionellem Allroundwissen auch sein ganz spezielles Gebiet, um selbst die individuellsten Kundenwünsche schnell und kompetent umzusetzen.
                            </p>
                        </div>
                        <ul class="team3">
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
<script type="text/javascript">
//获取元素
window.onload = function () {
        var arrow = document.querySelector('#header .headerMain .arrow');
        var upNodes =document.querySelectorAll('#header .headerMain .nav ul li .up');
        var liNodes = document.querySelectorAll('#header .headerMain .nav ul li');
        var header = document.getElementById('header');
        var content = document.getElementById('content');
        var contentLi = document.querySelectorAll('#content .list>li');
        var contentList = document.querySelector('#content .list');
        var aboutUl = document.querySelectorAll('#content .list .about .about3>.item>ul');
        var homeList = document.querySelector('#content .list .home .homeList');
        var homeIcon = document.querySelector('#content .list .home .homeIcon');
        var plane1 = document.querySelector('#content .course .plane1');
        var plane2 = document.querySelector('#content .course .plane2');
        var plane3 = document.querySelector('#content .course .plane3');
        var pencel1 = document.querySelector('#content .works .pencel1');
        var pencel2 = document.querySelector('#content .works .pencel2');
        var pencel3 = document.querySelector('#content .works .pencel3');
        var item1 = document.querySelectorAll('#content .list .about .about3>.item')[0];
        var item2 = document.querySelectorAll('#content .list .about .about3>.item')[1];
        var team1 = document.querySelector('#content .list .team>.team1');
        var team2 = document.querySelector('#content .list .team>.team2');
        var maskTop = document.querySelector('#mask .maskTop');
        var maskBottom = document.querySelector('#mask .maskBottom');
        var maskLine = document.querySelector('#mask .maskLine');
        var mask = document.getElementById('mask');
        var homeLi = document.querySelectorAll('#content .list .home .homeList>li');
        var homeIconli = document.querySelectorAll('#content .list .home .homeIcon>li');
        var menuBarLi = document.querySelectorAll('#content .menuBar>li');
        var preIndex = 0;   //记录上一次屏幕索引值，再每一次更新now的值之前，将now的值赋给它
        var now = 0;    //li下标
        var timer = null;
        var autoTimer1 =null;
        var music = document.querySelector('#header .headerMain .music');
        var myAudio = document.querySelector('#header .headerMain .music>audio');
        //开机动画
        loading();
        function loading() {
            //图片标识个数
            var imgFlag = 0;
            var arr = ['bg1.jpg','bg2.jpg','bg3.jpg','bg4.jpg','bg5.jpg','about1.jpg','about2.jpg','about3.jpg','about4.jpg','worksimg1.jpg','worksimg2.jpg','worksimg3.jpg','worksimg4.jpg','team.png','greenLine.png'];
            for (var i =0;i<arr.length;i++){
                var imgNode = new Image();
                imgNode.src = 'img/'+arr[i];
                imgNode.onload = function () {
                    imgFlag++;
                    maskLine.style.width = imgFlag/arr.length*100+'%';

                }
            }
                maskLine.addEventListener('transitionend',function () {
                    maskTop.style.height = '0';
                    maskBottom.style.height = '0';
                    maskLine.style.display = 'none';
                })
                //transitionend 和过渡属性个数有关
                maskTop.addEventListener('transitionend',function () {
                    //第一屏入场
                    animationArr[0]['inAin']();
                    home3D();
                    mask.remove();
                })

        }
        //音频
        music.onclick = function () {
            //判断如果是否为暂停，true为暂停，要执行播放
            if(myAudio.paused){
                //播放
                myAudio.play();
                music.style.backgroundImage = 'url("img/musicon.gif")';
            }else{
                //暂停
                myAudio.pause();
                music.style.backgroundImage = 'url("img/musicoff.gif")';
            }
        }

        //出入场动画
        var animationArr = [
            {
            //第一屏
                inAin:function () {
                    homeList.style.transform = 'translateY(0px)';
                    homeIcon.style.transform = 'translateY(0px)';
                    homeList.style.opacity = '1';
                    homeIcon.style.opacity = '1';
                },
                outAin:function () {
                    homeList.style.transform = 'translateY(-200px)';
                    homeIcon.style.transform = 'translateY(200px)';
                    homeList.style.opacity = '0';
                    homeList.style.opacity = '0';
                }
            },{
            //第二屏
                inAin:function () {
                    plane1.style.transform = 'translate(0px,0px)';
                    plane2.style.transform = 'translate(0px,0px)';
                    plane3.style.transform = 'translate(0px,0px)';
    
                },
                outAin:function () {
                    plane1.style.transform = 'translate(-200px,-200px)';
                    plane2.style.transform = 'translate(-200px,200px)';
                    plane3.style.transform = 'translate(200px,-200px)';
                }
            },
            {
            //    第三屏
                inAin:function () {
                    pencel1.style.transform = 'translateY(0px)';
                    pencel2.style.transform = 'translateY(0px)';
                    pencel3.style.transform = 'translateY(0px)';
                },
                outAin:function () {
                    pencel1.style.transform = 'translateY(-200px)';
                    pencel2.style.transform = 'translateY(200px)';
                    pencel3.style.transform = 'translateY(200px)';
                }
            },
            {
            //    第四屏
                inAin:function () {
                    item1.style.transform = 'rotate(0deg)';
                    item2.style.transform = 'rotate(0deg)';
                },
                outAin:function () {
                    item1.style.transform = 'rotate(45deg)';
                    item2.style.transform = 'rotate(-45deg)';

                }
            },
            {
            //第五屏
                inAin:function () {
                    team1.style.transform = 'translateX(0px)';
                    team2.style.transform = 'translateX(0px)';
                },
                outAin:function () {
                    team1.style.transform = 'translateX(-200px)';
                    team2.style.transform = 'translateX(200px)';
                }
            }];
        //使所有处于出场状态
        for (var i = 0; i < 5;i++ ){
            animationArr[i]['outAin']();
        }
        //第一屏
        var oldIndex = 0;
        var autoIndex = 0;
        function home3D(){
            //点击小圆点
            var autoTimer = null;
            for (var i = 0; i < homeIconli.length;i++){
                    homeIconli[i].index = i;
                    homeIconli[i].onclick = function () {
                    //清除定时器
                    clearInterval(autoTimer1);
                    console.log(autoTimer1)
                    //清空li的className
                    for (var j = 0 ;j < homeIconli.length; j++){
                        homeIconli[j].className = '';
                    }
                    this.className = 'active';
                    //判断点击的是右侧还是左侧
                    if (oldIndex < this.index){
                        //点击右侧，右侧显示左侧隐藏
                        homeLi[oldIndex].className = 'leftHide';
                        homeLi[this.index].className = 'rightShow'
                    }else if (oldIndex > this.index){
                        //点击左侧，左侧显示右侧隐藏
                        homeLi[oldIndex].className = 'rightHide';
                        homeLi[this.index].className ='leftShow';
                    }
                    oldIndex = this.index;
                    autoIndex = this.index;
                    //重新启动定时器
                    auto();
                }
            }


            //自动轮播
            auto();
            function auto() {
                autoTimer1 = setInterval(function () {
                    autoIndex++;
                    //判断临界值
                    if(autoIndex == homeIconli.length){
                        autoIndex = 0;
                    }
                    //自动轮播都是相当于点击右侧，即右侧显示左侧隐藏
                    homeLi[oldIndex].className = 'leftHide';
                    homeLi[autoIndex].className = 'rightShow';
                    //清空所有小圆点的类名
                    for (var i = 0; i < homeIconli.length;i++){
                        homeIconli[i].className =''
                    }
                    homeIconli[autoIndex].className = 'active';
                    //更新下标
                    oldIndex = autoIndex;
                },3000)
            }
        }
        picBoom()
        //图片炸裂
        function picBoom(){
            for(var i = 0; i < aboutUl.length; i++){
                changImg(aboutUl[i])
            }
            function changImg(ul) {
                var w = ul.offsetWidth/2;
                var h = ul.offsetHeight/2;
                //获取ul上边的data-src属性
                var imgSrc = ul.dataset.src;
                //创建li
                for (var i = 0; i < 4; i++){
                    var liNode = document.createElement('li');
                //    设置li的宽高
                    liNode.style.width = w+'px';
                    liNode.style.height = h+'px';
                    //li里面添加图片
                    var imgNode = new Image();
                    imgNode.src = imgSrc;
                    //将li追加到ul中
                    ul.appendChild(liNode);
                    imgNode.style.top = -Math.floor(i/2)*h+'px';
                    imgNode.style.left = -(i%2)*w+'px';
                    //将图片追加到li里面
                    liNode.appendChild(imgNode);
                }
                //document会获取到8张图
                var imgNodes = ul.querySelectorAll('li img');
                ul.onmouseenter = function () {
                    imgNodes[0].style.top = h+'px';
                    imgNodes[1].style.left = -2*w+'px';
                    imgNodes[2].style.left = w+'px';
                    imgNodes[3].style.top = -2*h+'px'
                }
                ul.onmouseleave = function () {
                    imgNodes[0].style.top = 0+'px';
                    imgNodes[1].style.left = -w+'px';
                    imgNodes[2].style.left = 0+'px';
                    imgNodes[3].style.top = -h+'px'
                }
            }
        }
        move(now);
        //滚轮
        document.onmousewheel = function(event){
            clearTimeout(timer);
            timer = setTimeout(function () {
                fun(event)
            },200)
        };
        //兼容性处理
        if(document.addEventListener){
            document.addEventListener('DOMMouseScroll',function (event) {
                clearTimeout(timer);
                timer = setTimeout(function () {
                    fun(event)
                },200)
            })
        }
        function fun(event) {
            event = event||window.event;
            var flag = '';
            if(event.wheelDelta){
                //ie chrom
                //判断上下
                if(event.wheelDelta>0){
                    //上
                    flag = 'up';
                }else {
                    flag = 'down'
                }
            }else if(event.detail){
                //firefox
                if(event.detail<0){
                    //上
                    flag = 'up'
                }else{
                    //下
                    flag = 'down'
                }

            }
            preIndex = now;
            //判断临界值,如果上一次已经到了顶部，且继续上滑
            //或者上一次已经到了底部，再往下都不再调用屏幕切换函数
            if((preIndex == 0 && flag == 'up')||(preIndex == liNodes.length-1 && flag == 'down')){
                return ;
            }
            switch (flag) {
                case "up":
                    if(now > 0){
                        now--;
                    }
                    move(now);
                    break;
                case "down":
                    if(now < liNodes.length-1){
                        now++
                    }
                    move(now);
                    break;
            }
            //阻止默认行为
            event.preventDefault && event.preventDefault();
            return false;
        }
        //视口发生改变时，更新内容区高度 更新三的位置
        window.onresize = function(){
            contentBind();
            //三角位置更新
            arrow.style.left = liNodes[now].getBoundingClientRect().left+liNodes[now].offsetWidth/2-arrow.offsetWidth/2+'px';
            //屏幕切换
            contentList.style.top = -now*(document.documentElement.clientHeight- header.offsetHeight)+'px';
        }
        contentBind();
        //设置内容区
        function contentBind() {
            //设置内容区高
            content.style.height = document.documentElement.clientHeight-header.offsetHeight+'px';
            for(var i = 0; i < contentLi.length ; i++){
                contentLi[i].style.height = document.documentElement.clientHeight - header.offsetHeight+'px';
            }
        }
        headerBind();
        //设置头部
        function headerBind(){
            //第一个up的宽度
            upNodes[0].style.width = '100%';
            //初始化小三角的位置
            arrow.style.left = liNodes[0].getBoundingClientRect().left+liNodes[0].offsetWidth/2-arrow.offsetWidth/2+'px';
            //for循环给所有的li添加index属性
            for (var i = 0; i < liNodes.length; i++){
                liNodes[i].index = i;
            //    给所有的li绑定单击事件
                liNodes[i].onclick = function () {
                    preIndex = now;
                    now = this.index;
                    if (preIndex == now){
                        return;
                    }
                    move(now)
                }
            }
            //侧边栏
            for (var i = 0; i < menuBarLi.length;i++){
                menuBarLi[i].index = i;
                menuBarLi[i].onclick = function () {
                    //切换屏幕，不能直接传this.index,否则下一次自动轮播时会乱
                    //将this.index赋值给now，防止自动轮播索引乱
                    preIndex = now;
                    now = this.index;
                    //判断preindex和now
                    if (preIndex == now){   //若值相同，不必再调用move函数
                        return;
                    }
                    move(now);

                }
            }
        }
        //设置屏幕切换
        function move(now) {
            //up高度为0
            for (var j = 0; j < upNodes.length ; j++){
                upNodes[j].style.width = '';
            } ;
            upNodes[now].style.width ='100%';
            arrow.style.left = liNodes[now].getBoundingClientRect().left+liNodes[now].offsetWidth/2-arrow.offsetWidth/2+'px';
            //切换屏幕
            contentList.style.top = -now*(document.documentElement.clientHeight-header.offsetHeight)+'px';
            //更新侧边导航小圆点的高亮
            for (var i = 0; i < menuBarLi.length; i++){
                menuBarLi[i].className = '';
            }
            menuBarLi[now].className = 'active';
            //给当前当进步的屏幕开启入场动画
            animationArr[now]['inAin']();
            //给上一次屏幕设置出场动画
            animationArr[preIndex]['outAin']();
        }
    }
</script>
</body>
</html>